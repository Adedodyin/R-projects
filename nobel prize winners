# Loading in required libraries
library(tidyverse)
library(readr)
library(ggplot2)
library(readxl)

# Reading in the Nobel Prize data
nobel <- read_excel('data/nobel.xlsx')

# Store and display the most commonly awarded gender and birth country in requested variables
nobel %>%
    group_by(sex) %>%
    count() %>%
 arrange(desc(n))

top_gender <- "Male"

nobel %>%
    group_by(birth_country) %>%
    count()  %>% 
    arrange(desc(n))  %>% 
    head(20)

top_country <- "United States of America"


# Calculating the proportion of USA born winners per decade
prop_usa_winners <- nobel %>% 
    mutate(usa_born_winner = birth_country == "United States of America",
           decade = floor(year / 10) * 10 ) %>% 
    group_by(decade) %>%
    summarize(proportion = mean(usa_born_winner, na.rm = TRUE))

# Identify the decade with the highest proportion of US-born winners
max_decade_usa <- "2000"

# Calculating the proportion of female laureates per decade
prop_female_winners <- nobel %>%
    mutate(female_winner = sex == "Female",
           decade = floor(year / 10) * 10) %>%
    group_by(decade, category) %>%
    summarize(proportion = mean(female_winner))

# Create a list with the decade and category pair
max_female_list <- list(decade = "2020",
                        category = "Literature")

# Finding the first woman to win a Nobel Prize
first_woman <- nobel %>%
    filter(sex == "Female") %>%
    top_n(1, desc(year))

first_woman_name <- "Marie Curie, nÃ©e Sklodowska"
first_woman_category <- "Physics"

# Selecting the laureates that have received 2 or more prizes
repeats <- nobel %>%
    group_by(full_name) %>% 
    count()  %>% 
    filter(n >= 2)

repeats
